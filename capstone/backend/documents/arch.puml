@startuml IDP_Copilot_Standalone
skinparam componentStyle rectangle
skinparam wrapWidth 200
skinparam maxMessageSize 200

actor "Developer" as Dev

rectangle "Chat UI\n(React / TypeScript)" as ChatUI
rectangle "Backend (Monolith)\nFastAPI + Google ADK" as Backend {
  rectangle "Conversation Module\n- start/end conversation\n- clarifications\n- task list mgmt\n- REST/WS API" as Conversation
  rectangle "Agent Orchestrator\n(Google ADK)\n- build & run task list\n- ask clarifications\n- call tools via MCP" as Agent
  rectangle "MCP Client\n- Git / FS / Template / CI/CD" as MCP
  database "RAG Store\n(ChromaDB)" as RAG
  database "Persistence\n(SQLite / PostgreSQL)" as DB
}

rectangle "MCP Tool Servers\n(Git, Filesystem, Template, CI/CD)" as Tools

Dev --> ChatUI : Use chat
ChatUI --> Conversation : REST / WebSocket
Conversation --> Agent : invoke / continue workflow (in-process)
Agent --> MCP : tool invocations (MCP)
MCP --> Tools : MCP protocol calls
Agent --> Conversation : progress / results / clarifications
Conversation --> DB : store/load conversations & tasks
Agent --> RAG : embed / retrieve guidelines & templates

@enduml
